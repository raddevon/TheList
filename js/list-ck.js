function makeNewItem(e){var t=$('<li class="new"><form action=""><input type="text" /></form></li>');if(e)t.appendTo($(".list ul")).removeClass("new");else if($(".list li").length===0&&$(".list li").first().val())t.prependTo($(".list ul")).removeClass("new");else{$(".list li").css("top",$(".list li").outerHeight());t.prependTo($(".list ul")).removeClass("new");$(".list li").css("top",0)}}function removeItem(e){currentList.item.splice(e,1);$(".list li:eq("+e+")").remove()}var currentList;(function(e){e.fn.newItem=function(){e(this).bind("click",function(){makeNewItem();currentList.item.unshift("")})}})(jQuery);$(document).on("input propertychange","input",function(){var e=$(this);if(window.event&&event.type=="propertychange"&&event.propertyName!="value")return;window.clearTimeout($(this).data("timeout"));$(this).data("timeout",setTimeout(function(){var t=e.parent().parent().index();currentList.item[t]=e.val()},5e3))});$(document).on("input propertychange","textarea",function(){var e=$(this),t=$(this).val();if(window.event&&event.type=="propertychange"&&event.propertyName!="value")return;window.clearTimeout($(this).data("timeout"));$(this).data("timeout",setTimeout(function(){var n=e.data("index");currentList.item[n].details=t},5e3))});$(document).on("focus","input",function(e){var t=$(this).parent().parent().index(),n=$(this);currentList.item[t]=n.val();var r=currentList.item[t].details||"";$("#intro").hide();$("#details").show().val(r).data("index",t)});$(document).on("blur","input",function(e){var t=$(this).val(),n=$(this).parent().parent().index(),r=$("#details").val()||null;if(!t&&currentList.item.length>1)removeItem(n);else{currentList.item[n]=t;currentList.item[n].details=r}$("#intro").show();$("#details").hide().val("")});$(window).on("beforeunload",function(){currentList.save()});$(document).ready(function(){currentList=new MyList;currentList.load();currentList.item&&$(".list li").first().remove();reversedList=currentList.item.reverse();$.map(reversedList,function(e){makeNewItem();$(".list li").first().find("input").val(e)})});