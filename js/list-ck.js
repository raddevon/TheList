function setItemText(e,t,n){e.item[t]||(e.item[t]={});e.item[t].itemText=n}function makeNewItem(e){var t=$('<li class="new"><form action=""><input type="text" /></form></li>');e=e||1;for(var n=0;n<e;n++)if($(".list li").length===0&&$(".list li").first().val())t.clone().prependTo($(".list ul")).removeClass("new");else{$(".list li").css("top",$(".list li").outerHeight());t.clone().prependTo($(".list ul")).removeClass("new");$(".list li").css("top",0)}}function removeItem(e){currentList.item.splice(e,1);$(".list li").eq(e).remove()}var currentList;(function(e){e.fn.newItem=function(){e(this).bind("click",function(){makeNewItem();currentList.item.unshift("");e(".list ul").find("li").eq(0).find("input").colorSlide().focus()})}})(jQuery);$(".list ul, .detail-column form").on("input propertychange","input, textarea",function(){var e=$(this);if(window.event&&event.type=="propertychange"&&event.propertyName!="value")return;window.clearTimeout($(this).data("timeout"));$(this).data("timeout",setTimeout(function(){var e=$(this).data("index")||$(this).parent().parent().index(),t=$(".list li ").eq(e).find("input").val(),n=$("#details").val()||null;setItemText(currentList,e,t);currentList.item[e].details=n;currentList.save()},5e3))});$(".list ul, .detail-column form").on("blur","input, textarea",function(){var e=$(this).data("index")||$(this).parent().parent().index(),t=$(".list li ").eq(e).find("input").val(),n=$("#details").val()||null;if(!t&&currentList.item.length>1)removeItem(e);else{setItemText(currentList,e,t);currentList.item[e].details=n}currentList.save()});$(window).on("beforeunload",function(){currentList.save()});$(".list ul").on("activated","li",function(){var e=$(this).index(),t=currentList.item[e].details||"";$("#intro").hide();$("#details").show().val(t).data("index",e)});$(".list ul").on("focus","input",function(){$(this).closest("li").trigger("activated")});$(document).ready(function(){currentList=new MyList;currentList.load();currentList.item&&$(".list li").first().remove();makeNewItem(currentList.item.length);$.map(currentList.item,function(e,t){$(".list li ").eq(t).find("input").val(e.itemText)})});